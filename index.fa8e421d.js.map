{"mappings":"AAiDiB,IA5CjB,MACEA,YAAYC,EAAMC,GAChBC,KAAKF,KAAOA,EACZE,KAAKD,SAAWA,EAChBC,KAAKC,MAAQC,GAAGC,WAAW,Q,CAI7BC,cAAcC,GAEZ,MAAMC,EAAM,IAAIC,KACVC,EAAO,CACXH,QAASA,EACTN,SAAUC,KAAKD,SACfD,KAAME,KAAKF,KACXW,WAAYC,SAASC,UAAUC,UAAUC,SAASP,IAKpD,aADuBN,KAAKC,MAAMa,IAAIN,E,CAKxCO,SAASC,GACPhB,KAAKC,MACFgB,MAAM,OAAQ,KAAMjB,KAAKF,MACzBoB,QAAQ,cACRC,YAAWC,IACVA,EAASC,aAAaC,SAAQC,IACV,UAAdA,EAAKC,MAEPR,EAASO,EAAKE,IAAIC,OAAO,GAE3B,G,CAKRC,WAAW5B,GACTC,KAAKD,SAAWA,C,GAIU,UAAW,SAEhCgB,UAASW,IAChBE,QAAQC,IAAIH,EAAK","sources":["src/scripts/chat.js"],"sourcesContent":["// TODO adding new chat documents\n// TODO setting up a real-time listener to get new chats\n// TODO updating the username\n// TODO updating the room\n\nclass Chatroom {\n  constructor(room, username) {\n    this.room = room;\n    this.username = username;\n    this.chats = db.collection('chats');\n  }\n\n  //*   metoda addChat (adauga un mesaj):\n  async addChat(message) {\n    //* format a chat object:\n    const now = new Date();\n    const chat = {\n      message: message,\n      username: this.username,\n      room: this.room,\n      created_at: firebase.firestore.Timestamp.fromDate(now), // Setăm data curentă.\n    };\n\n    //* save the chat document:\n    const response = await this.chats.add(chat);\n    return response;\n  }\n\n  //* metoda getChats (actualizeaza in timp real mesajele):\n  getChats(callback) {\n    this.chats\n      .where('room', '==', this.room)\n      .orderBy('created_at')\n      .onSnapshot(snapshot => {\n        snapshot.docChanges().forEach(elem => {\n          if (elem.type === 'added') {\n            //* update the UI:\n            callback(elem.doc.data());\n          }\n        });\n      });\n  }\n\n  //*   metoda update username:\n  updateName(username) {\n    this.username = username;\n  }\n}\n\nconst chatroom = new Chatroom('general', 'shaun');\n\nchatroom.getChats(data => {\n  console.log(data);\n});\n"],"names":["constructor","room","username","this","chats","db","collection","async","message","now","Date","chat","created_at","firebase","firestore","Timestamp","fromDate","add","getChats","callback","where","orderBy","onSnapshot","snapshot","docChanges","forEach","elem","type","doc","data","updateName","console","log"],"version":3,"file":"index.fa8e421d.js.map"}